{"version":3,"sources":["webpack:///./src/views/ProposalPage.vue?90ec","webpack:///./src/views/ProposalPage.vue?caa9","webpack:///src/views/ProposalPage.vue","webpack:///./src/views/ProposalPage.vue?c7a1","webpack:///./src/views/ProposalPage.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","on","onLogin","onLogout","staticClass","_v","_s","proposal","subject","style","backgroundImage","image","creator","image_receiver","receiver","attrs","url","start_date","end_date","total_time","daily_pay","total_pay","status","status_extended","votes_sp","$store","state","auth","saving","vote","_e","display_button","alert","infoText","domProps","successText","dangerText","votes","length","directives","name","rawName","value","expression","$event","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","sort_order","multiple","_l","index","key","voter","votes_description","staticRenderFns","data","components","HeaderEFTG","mixins","created","getChainProperties","then","watch","methods","sortBy","sort","Error","isActive","now","Date","witness_vote_weight","no_proxy_vote_weight","account","proxy_vote_weight","Math","floor","parseFloat","vesting_shares","total","parseInt","proxied_vsf_votes","i","calculate_vote","no_proxy_votes","proxy_votes","witnessVotes2sp","user","activeKey","keys","active","ownerKey","privKey","id","$route","params","showDanger","ops","hideSuccess","hideDanger","hideInfo","steem_broadcast_sendOperations","self","showSuccess","loadVotesFromAccount","error","message","console","log","component"],"mappings":"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","file":"js/chunk-7141bc53.aa950e99.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalPage.vue?vue&type=style&index=0&id=4c5111de&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalPage.vue?vue&type=style&index=0&id=4c5111de&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('HeaderEFTG',{ref:\"headerEFTG\",on:{\"login\":_vm.onLogin,\"logout\":_vm.onLogout}}),_c('div',{staticClass:\"container\"},[_c('h2',[_vm._v(_vm._s(_vm.proposal.subject))]),_c('div',{staticClass:\"row mt-3 mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Creator\")]),_c('div',{staticClass:\"col-10\"},[_c('div',{staticClass:\"image-profile mr-2\",style:({ backgroundImage: 'url(' + _vm.proposal.image + ')' })}),_c('span',[_vm._v(_vm._s(_vm.proposal.creator))])])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Receiver\")]),_c('div',{staticClass:\"col-10\"},[_c('div',{staticClass:\"image-profile mr-2\",style:({ backgroundImage: 'url(' + _vm.proposal.image_receiver + ')' })}),_c('span',[_vm._v(_vm._s(_vm.proposal.receiver))])])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Subject\")]),_c('div',{staticClass:\"col-10\"},[_c('router-link',{attrs:{\"to\":_vm.proposal.url}},[_vm._v(_vm._s(_vm.proposal.subject))])],1)]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Start date\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.start_date))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"End date\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.end_date))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Total days\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.total_time))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Daily pay\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.daily_pay))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Total pay\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.total_pay))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Status\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.status)+\" \"+_vm._s(_vm.proposal.status_extended))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Votes\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.votes_sp))])]),(this.$store.state.auth.logged)?_c('div',{staticClass:\"row mt-4\"},[_c('div',{staticClass:\"form-group col-12\"},[_c('button',{staticClass:\"btn btn-primary btn-large mr-2\",attrs:{\"disabled\":_vm.saving},on:{\"click\":_vm.vote}},[(_vm.saving)?_c('div',{staticClass:\"mini loader\"}):_vm._e(),_vm._v(_vm._s(_vm.display_button))])])]):_vm._e(),(_vm.alert.info)?_c('div',{staticClass:\"alert alert-info\",attrs:{\"role\":\"alert\"}},[_vm._v(_vm._s(_vm.alert.infoText))]):_vm._e(),(_vm.alert.success)?_c('div',{staticClass:\"alert alert-success\",attrs:{\"role\":\"alert\"},domProps:{\"innerHTML\":_vm._s(_vm.alert.successText)}}):_vm._e(),(_vm.alert.danger)?_c('div',{staticClass:\"alert alert-danger\",attrs:{\"role\":\"alert\"}},[_vm._v(_vm._s(_vm.alert.dangerText))]):_vm._e(),_c('h3',{staticClass:\"mt-5\"},[_vm._v(_vm._s(_vm.votes.length)+\" Votes\")]),_c('div',{staticClass:\"row mb-3\"},[_c('div',{staticClass:\"col-12 text-right\"},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.sort_order),expression:\"sort_order\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.sort_order=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"votes\"}},[_vm._v(\"Sort by votes\")]),_c('option',{attrs:{\"value\":\"name\"}},[_vm._v(\"Sort by name\")])])])]),_c('div',{staticClass:\"card mb-2\"},[_c('ul',{staticClass:\"list-group list-group-flush\"},_vm._l((_vm.votes),function(vote,index){return _c('li',{key:index,staticClass:\"list-group-item\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-3\"},[_vm._v(\"@\"+_vm._s(vote.voter))]),_c('div',{staticClass:\"col-2\"},[_vm._v(_vm._s(vote.votes_sp))]),_c('div',{staticClass:\"col-7\"},[_vm._v(_vm._s(vote.votes_description))])])])}),0)])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <HeaderEFTG ref=\"headerEFTG\" v-on:login=\"onLogin\" v-on:logout=\"onLogout\"></HeaderEFTG>\r\n    <div class=\"container\">\r\n      <h2>{{proposal.subject}}</h2>\r\n      <div class=\"row mt-3 mb-2\">\r\n        <div class=\"col-2\">Creator</div>\r\n        <div class=\"col-10\">\r\n          <div class=\"image-profile mr-2\" :style=\"{ backgroundImage: 'url(' + proposal.image + ')' }\"></div>\r\n          <span>{{proposal.creator}}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">Receiver</div>\r\n        <div class=\"col-10\">\r\n          <div class=\"image-profile mr-2\" :style=\"{ backgroundImage: 'url(' + proposal.image_receiver + ')' }\"></div>\r\n          <span>{{proposal.receiver}}</span>\r\n        </div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">Subject</div>\r\n        <div class=\"col-10\">\r\n          <router-link :to=\"proposal.url\">{{proposal.subject}}</router-link>\r\n        </div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">Start date</div>\r\n        <div class=\"col-10\">{{proposal.start_date}}</div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">End date</div>\r\n        <div class=\"col-10\">{{proposal.end_date}}</div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">Total days</div>\r\n        <div class=\"col-10\">{{proposal.total_time}}</div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">Daily pay</div>\r\n        <div class=\"col-10\">{{proposal.daily_pay}}</div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">Total pay</div>\r\n        <div class=\"col-10\">{{proposal.total_pay}}</div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">Status</div>\r\n        <div class=\"col-10\">{{proposal.status}} {{proposal.status_extended}}</div>\r\n      </div>\r\n      <div class=\"row mb-2\">\r\n        <div class=\"col-2\">Votes</div>\r\n        <div class=\"col-10\">{{proposal.votes_sp}}</div>\r\n      </div>\r\n      <div v-if=\"this.$store.state.auth.logged\" class=\"row mt-4\">\r\n        <div class=\"form-group col-12\">\r\n          <button @click=\"vote\" class=\"btn btn-primary btn-large mr-2\" :disabled=\"saving\"><div v-if=\"saving\" class=\"mini loader\"></div>{{display_button}}</button>\r\n        </div>\r\n      </div>\r\n      <div v-if=\"alert.info\" class=\"alert alert-info\" role=\"alert\">{{alert.infoText}}</div>\r\n      <div v-if=\"alert.success\" class=\"alert alert-success\" role=\"alert\" v-html=\"alert.successText\"></div>\r\n      <div v-if=\"alert.danger\"  class=\"alert alert-danger\" role=\"alert\">{{alert.dangerText}}</div>\r\n\r\n      <h3 class=\"mt-5\">{{votes.length}} Votes</h3>\r\n      <div class=\"row mb-3\">\r\n        <div class=\"col-12 text-right\">\r\n          <select v-model=\"sort_order\">\r\n            <option value=\"votes\">Sort by votes</option>\r\n            <option value=\"name\">Sort by name</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n      <div class=\"card mb-2\">\r\n        <ul class=\"list-group list-group-flush\">\r\n          <li v-for=\"(vote,index) in votes\" :key=\"index\" class=\"list-group-item\">\r\n            <div class=\"row\">\r\n              <div class=\"col-3\">@{{vote.voter}}</div>\r\n              <div class=\"col-2\">{{vote.votes_sp}}</div>\r\n              <div class=\"col-7\">{{vote.votes_description}}</div>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport HeaderEFTG from '@/components/HeaderEFTG'\r\nimport SteemClient from '@/mixins/SteemClient.js'\r\nimport Alerts from '@/mixins/Alerts.js'\r\nimport Utils from '@/js/utils.js'\r\n\r\nimport Config from '@/config.js'\r\nimport ChainProperties from '@/mixins/ChainProperties.js'\r\n\r\n\r\nexport default {\r\n  name: 'ProposalPage',\r\n\r\n  data() {\r\n    return {\r\n      proposal: {url:''},\r\n      votes: [],\r\n      sort_order: 'votes',\r\n      display_button: 'Vote',\r\n      saving: false,\r\n    }\r\n  },\r\n\r\n  components: {\r\n    HeaderEFTG\r\n  },\r\n\r\n  mixins: [\r\n    ChainProperties,\r\n    SteemClient,\r\n    Alerts\r\n  ],\r\n\r\n  created() {\r\n    this.getChainProperties().then( ()=>{\r\n      this.getProposal()\r\n    })\r\n  },\r\n\r\n  watch: {\r\n    sort_order: function(new_order){ this.sortBy(new_order) },\r\n  },\r\n\r\n  methods: {\r\n    async getProposal(){\r\n      var id = this.$route.params.id\r\n      var proposals = await this.steem_database_call('find_proposals',[[id]])\r\n      console.log(proposals)\r\n      if(!proposals || proposals.length==0){\r\n        this.showDanger(`Proposal number #${id} does not exists`)\r\n        throw new Error(`Proposal number #${id} does not exists`)\r\n      }\r\n      var proposal = proposals[0]\r\n      var delta_t = new Date(proposal.end_date) - new Date(proposal.start_date)\r\n      proposal.url = Config.EXPLORER + '@' + proposal.creator + '/' + proposal.permlink\r\n      proposal.image = 'https://img.blurt.world/profileimage/'+proposal.creator\r\n      proposal.image_receiver = 'https://img.blurt.world/profileimage/'+proposal.receiver\r\n      proposal.votes_sp = this.witnessVotes2sp(proposal.total_votes)\r\n      proposal.vote = false\r\n      proposal.newVote = false\r\n      proposal.total_time = Utils.textTime(delta_t)\r\n      proposal.total_pay = (parseFloat(proposal.daily_pay) * delta_t / (1000*60*60*24)).toFixed(3) + ' ' + Config.SP\r\n      proposal.active = this.isActive(proposal)\r\n      proposal.status = proposal.active ? 'active' : 'inactive'\r\n      if(proposal.active){\r\n        proposal.status = 'active'\r\n        proposal.status_extended = ''\r\n      }else{\r\n        proposal.status = 'inactive'\r\n        proposal.status_extended = `(becomes active in ${Utils.textTime(new Date(proposal.start_date+'Z') - Date.now())})`\r\n      }\r\n      this.proposal = proposal\r\n      console.log(`total votes ${proposal.total_votes}`)\r\n\r\n      if(this.$store.state.auth.logged) this.loadVotesFromAccount()\r\n      this.loadVotes()\r\n    },\r\n\r\n    sortBy(type){\r\n      switch(type){\r\n        case 'votes':\r\n          this.votes.sort( (a,b)=>{ return parseInt(b.votes) - parseInt(a.votes) })\r\n          return\r\n        case 'name':\r\n          this.votes.sort( (a,b)=>{ return a.voter.localeCompare(b.voter) })\r\n          return\r\n        default:\r\n          throw new Error(`The type '${type}' for sort does not exists`)\r\n      }\r\n    },\r\n\r\n    isActive(proposal){\r\n      var now = Date.now()\r\n      return now <= new Date(proposal.end_date+'Z') && now >= new Date(proposal.start_date+'Z')\r\n    },\r\n\r\n    async loadVotes(){\r\n      var proposal = this.proposal\r\n      proposal.total_votes = 0\r\n      var from = ''\r\n      var break_while = false\r\n      var voters = []\r\n      while(!break_while){\r\n        var votes = await this.steem_database_call('list_proposal_votes',[[proposal.id,from],100,'by_proposal_voter'])\r\n\r\n        if(votes.length == 1){\r\n          break_while = true\r\n          if(votes[0].proposal.id == proposal.id) voters.push(votes[0].voter)\r\n        }else{\r\n          for(var j=0; j<votes.length-1; j++){ //don't take the last one. It is for the next round\r\n            if(votes[j].proposal.id !== proposal.id){\r\n              break_while = true\r\n              break\r\n            }\r\n            voters.push(votes[j].voter)\r\n          }\r\n        }\r\n        from = votes[votes.length-1].voter\r\n      }\r\n      console.log(`voters of id ${proposal.id}`)\r\n      console.log(voters)\r\n      this.votes = []\r\n      var accounts = await this.steem_database_call('get_accounts',[voters])\r\n      for(var j in accounts){\r\n        var account = accounts[j]\r\n        var vote = this.calculate_vote(account)\r\n        this.votes.push(vote)\r\n        proposal.total_votes += vote.votes\r\n      }\r\n      console.log(`total votes ${proposal.total_votes}`)\r\n      proposal.votes_sp = this.witnessVotes2sp(proposal.total_votes)\r\n      this.proposal = proposal\r\n      this.sortBy(this.sort_order)\r\n    },\r\n\r\n    witness_vote_weight(account) {\r\n      if(account.proxy !== '') return 0\r\n      return this.no_proxy_vote_weight(account) + this.proxy_vote_weight(account)\r\n    },\r\n\r\n    no_proxy_vote_weight(account){\r\n      return Math.floor(parseFloat(account.vesting_shares)*1e6)\r\n    },\r\n\r\n    proxy_vote_weight(account) {\r\n      var total = 0\r\n      for(var i in account.proxied_vsf_votes)\r\n        total += parseInt(account.proxied_vsf_votes[i])\r\n      return total\r\n    },\r\n\r\n    calculate_vote(account) {\r\n      var vote = {\r\n        voter: account.name,\r\n        votes: this.witness_vote_weight(account),\r\n        no_proxy_votes: this.no_proxy_vote_weight(account),\r\n        proxy_votes: this.proxy_vote_weight(account),\r\n      }\r\n      if(account.proxy === ''){ //no proxy set\r\n        vote.votes_sp = this.witnessVotes2sp(vote.votes)\r\n        if(vote.proxy_votes>0)\r\n          vote.votes_description = `(${this.witnessVotes2sp(vote.no_proxy_votes)} + ${this.witnessVotes2sp(vote.proxy_votes)} proxy)`\r\n        else\r\n          vote.votes_description = ''\r\n      }else{\r\n        vote.votes_sp = this.witnessVotes2sp(0)\r\n        vote.votes_description = `(${this.witnessVotes2sp(vote.no_proxy_votes)}`\r\n        if(vote.proxy_votes>0)\r\n          vote.votes_description += ` + ${this.witnessVotes2sp(vote.proxy_votes)} proxy,`\r\n        vote.votes_description += ` proxied to @${account.proxy})`\r\n      }\r\n      return vote\r\n    },\r\n\r\n    async loadVotesFromAccount(){\r\n      var user = this.$store.state.auth.user\r\n      var id = this.$route.params.id\r\n      this.clearVotes()\r\n      var account_votes = await this.steem_database_call('list_proposal_votes',[[user,id],1,'by_voter_proposal'])\r\n      if(!account_votes || account_votes.length==0){\r\n        this.proposal.vote = false\r\n        this.display_button = 'Vote'\r\n      }else{\r\n        this.proposal.vote = true\r\n        this.display_button = 'Remove vote'\r\n      }\r\n    },\r\n\r\n    vote(){\r\n      var user = this.$store.state.auth.user\r\n      var activeKey = this.$store.state.auth.keys.active\r\n      var ownerKey  = this.$store.state.auth.keys.owner\r\n      var privKey = null\r\n      var id = this.$route.params.id\r\n\r\n      if( activeKey != null ) {\r\n        privKey = activeKey\r\n      }else if(ownerKey != null ) {\r\n        privKey = ownerKey\r\n      }else {\r\n        this.showDanger('Please login with master, owner, or active key')\r\n        return\r\n      }\r\n\r\n      var ops = [[\r\n        'update_proposal_votes',\r\n        {\r\n          voter: user,\r\n          proposal_ids: [id],\r\n          approve: !this.proposal.vote,\r\n          extensions: []\r\n        }\r\n      ]]\r\n\r\n      this.saving = true\r\n      this.hideSuccess()\r\n      this.hideDanger()\r\n      this.hideInfo()\r\n\r\n      let self = this\r\n\r\n      this.steem_broadcast_sendOperations(ops,privKey)\r\n      .then(function(result){\r\n        self.saving = false\r\n        self.showSuccess(`<a href=\"${Config.EXPLORER2}b/${result.block_num}/${result.id}\" class=\"alert-link\" target=\"_blank\">Vote saved!</a>`)\r\n        self.loadVotesFromAccount()\r\n      })\r\n      .catch(function(error){\r\n        self.saving = false\r\n        self.showDanger(error.message)\r\n        console.log('operations')\r\n        console.log(ops)\r\n        throw error\r\n      })\r\n    },\r\n\r\n    onLogin() {\r\n      this.loadVotesFromAccount()\r\n      this.hideSuccess()\r\n      this.hideDanger()\r\n      this.hideInfo()\r\n    },\r\n\r\n    onLogout() {\r\n      this.hideSuccess()\r\n      this.hideDanger()\r\n      this.hideInfo()\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.hash {\r\n  font-family: monospace;\r\n  //font-size: 1.3rem;\r\n  overflow-wrap: break-word;\r\n}\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalPage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProposalPage.vue?vue&type=template&id=4c5111de&scoped=true&\"\nimport script from \"./ProposalPage.vue?vue&type=script&lang=js&\"\nexport * from \"./ProposalPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ProposalPage.vue?vue&type=style&index=0&id=4c5111de&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4c5111de\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}